"use strict";(self.webpackChunksc_codeworks_app=self.webpackChunksc_codeworks_app||[]).push([[75359],{75359:(at,d,l)=>{l.r(d),l.d(d,{TallysVerificationComponent:()=>et});var T=l(98739),r=l(7155),D=l(70879),E=l(35226),g=l.n(E),h=l(48529),t=l(94650),m=l(24006),y=l(19132),U=l(15627),C=l(36895),b=l(97392),Z=l(28255),I=l(4859),A=l(59549),M=l(44144),P=l(84385),v=l(3238),_=l(73546),S=l(10266),O=l(90455);function R(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.searchTallys())}),t.TgZ(1,"mat-icon"),t._uU(2,"clear"),t.qZA()()}}function N(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"button",31),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.searchTallys())}),t.TgZ(1,"mat-icon"),t._uU(2,"search"),t.qZA()()}}function V(a,o){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",32)(2,"div",33)(3,"span",34),t.NdJ("click",function(n){return n.stopPropagation()}),t.TgZ(4,"mat-slide-toggle",35),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).$implicit;return t.KtG(c.isActive=n)})("change",function(){const s=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.toggleColumn(s))}),t._uU(5),t.qZA()()()(),t.BQk()}if(2&a){const e=o.$implicit;t.xp6(4),t.Q6J("ngModel",e.isActive),t.xp6(1),t.hij(" ",e.name," ")}}function x(a,o){1&a&&(t.TgZ(0,"button",55),t._uU(1," Search "),t.qZA())}function L(a,o){if(1&a&&(t.TgZ(0,"form",36)(1,"div",32)(2,"div",37)(3,"mat-form-field",38)(4,"mat-label"),t._uU(5,"Tally"),t.qZA(),t._UZ(6,"input",39),t.qZA(),t.TgZ(7,"mat-form-field",38)(8,"mat-label"),t._uU(9,"Carrier"),t.qZA(),t._UZ(10,"input",40),t.qZA(),t.TgZ(11,"mat-form-field",38)(12,"mat-label"),t._uU(13,"Storer"),t.qZA(),t._UZ(14,"input",41),t.qZA(),t.TgZ(15,"mat-form-field",42)(16,"mat-label"),t._uU(17,"Reference"),t.qZA(),t._UZ(18,"input",43),t.qZA(),t.TgZ(19,"mat-form-field",38)(20,"mat-label"),t._uU(21,"Appointment"),t.qZA(),t._UZ(22,"input",44),t.qZA(),t.TgZ(23,"mat-form-field",38)(24,"mat-label"),t._uU(25,"Building/Door"),t.qZA(),t._UZ(26,"input",45),t.qZA(),t.TgZ(27,"mat-form-field",38)(28,"mat-label"),t._uU(29,"Appt Date"),t.qZA(),t._UZ(30,"input",46),t.qZA(),t.TgZ(31,"mat-form-field",38)(32,"mat-label"),t._uU(33,"Trailer Number"),t.qZA(),t._UZ(34,"input",47),t.qZA(),t.TgZ(35,"mat-form-field",38),t._UZ(36,"input",48),t.qZA(),t.TgZ(37,"mat-form-field",38)(38,"mat-label"),t._uU(39,"Tally Variance"),t.qZA(),t.TgZ(40,"mat-select",49)(41,"mat-option",50),t._uU(42,"-- Select --"),t.qZA(),t.TgZ(43,"mat-option",51),t._uU(44,"Yes"),t.qZA(),t.TgZ(45,"mat-option",52),t._uU(46,"No"),t.qZA()()(),t.TgZ(47,"mat-form-field",38)(48,"mat-label"),t._uU(49,"Tally Damaged"),t.qZA(),t.TgZ(50,"mat-select",53)(51,"mat-option",50),t._uU(52,"-- Select --"),t.qZA(),t.TgZ(53,"mat-option",51),t._uU(54,"Yes"),t.qZA(),t.TgZ(55,"mat-option",52),t._uU(56,"No"),t.qZA()()()()(),t.YNc(57,x,2,0,"button",54),t.qZA()),2&a){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(57),t.Q6J("ngIf",e.searchTextDisplay)}}function B(a,o){1&a&&(t.TgZ(0,"th",56),t._uU(1,"Item "),t.qZA())}function q(a,o){if(1&a&&(t.TgZ(0,"td",57),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.xp6(1),t.Oqu(e.IDITEM)}}function W(a,o){1&a&&(t.TgZ(0,"th",56),t._uU(1,"In Transit"),t.qZA())}function Y(a,o){if(1&a&&(t.TgZ(0,"td",57),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.xp6(1),t.hij("",e.WQINT," ")}}function K(a,o){1&a&&(t.TgZ(0,"th",56),t._uU(1,"Received"),t.qZA())}function J(a,o){if(1&a&&(t.TgZ(0,"td",57),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.xp6(1),t.hij("",e.WQREC," ")}}function Q(a,o){1&a&&(t.TgZ(0,"th",56),t._uU(1,"Damaged"),t.qZA())}function F(a,o){if(1&a&&(t.TgZ(0,"td",57),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.xp6(1),t.Oqu(e.IDQDAM)}}function w(a,o){1&a&&(t.TgZ(0,"th",56),t._uU(1,"Variance "),t.qZA())}function k(a,o){if(1&a&&(t.TgZ(0,"td",57),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.xp6(1),t.Oqu(e.WVAR)}}function H(a,o){1&a&&(t.TgZ(0,"th",56),t._uU(1," Status "),t.qZA())}function z(a,o){if(1&a&&(t.TgZ(0,"td",57),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.xp6(1),t.Oqu(e.WSTAT)}}function G(a,o){1&a&&(t.TgZ(0,"th",56),t._uU(1,"Lots"),t.qZA())}function $(a,o){if(1&a&&(t.TgZ(0,"td",57),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.xp6(1),t.hij(" ",e.WLOTS," ")}}function j(a,o){1&a&&t._UZ(0,"tr",58)}function X(a,o){1&a&&t._UZ(0,"tr",59)}const tt=function(){return[8,16,24]};let et=(()=>{class a{constructor(e,i,n,s,c){this.fb=e,this.router=i,this.route=n,this.IheaderService=s,this.cdr=c,this.TallyReadURL="/main-nav/tallys/read",this.isLoading=!1,this.searchTextDisplay=!1,this.user=localStorage.getItem("userName")||"",this.dataSource=new r.by,this.pageSize=8,this.totalRecords=0,this.currentFilters=null,this.INITIAL_PAGE=1,this.DEFAULT_PAGE_SIZE=8,this.selectedRow=[],this.editedRows=[],this.columnShowHideList=[],this.displayedColumns=["Item","InTransit","Received","Damaged","Variance","Status"]}ngOnInit(){const e=history.state;this.result=e[0],this.totalRecords=e[1],this.fullDetails=e[2],this.filters=e[3],this.TallysFormData=e[4],console.log("fullDetails Form tally:",this.fullDetails),this.form=this.fb.group({Tally:this.fullDetails.Tally,Carrier:(this.fullDetails.Carrier||"").trim(),storer:this.fullDetails.Storer,Reference:(this.fullDetails.Reference||"").trim(),Appointment:this.fullDetails.Appointment,BuildingDoor:this.fullDetails["Building/Door"],ApptDate:this.fullDetails["Appt Date"],TrailerNumber:this.fullDetails["Trailer Number"],TallyExist:this.fullDetails.Message,TallyVariance:"",TallyDamaged:""}),this.dataSource=new r.by(this.result),this.initializeColumnProperties(),this.getTallyVerification(this.pageSize,1),this.dataSource.filterPredicate=this.createFilter()}resetSearch(){this.form.patchValue({TallyVariance:"",TallyDamaged:""}),this.currentFilters=null,this.paginator.firstPage(),this.getTallyVerification(this.pageSize,1)}searchTallys(){this.searchTextDisplay=1!=this.searchTextDisplay}onPaginateChange(e){this.pageSize=e.pageSize,this.getTallyVerification(e.pageSize,e.pageIndex+1)}getTallyVerification(e=this.INITIAL_PAGE,i=this.DEFAULT_PAGE_SIZE){this.isLoading=!0,this.getAll2Subscription&&this.getAll2Subscription.unsubscribe(),this.getAll2Subscription=this.IheaderService.TallyVerification(this.user,this.IHTALY,this.filters?.WDISPL,this.filters?.WSERL,this.filters?.WSUPP,this.filters?.WLOT,e,i).subscribe({next:n=>{console.log("Raw Response:",n);try{const s=n?.[0]?.data?.[1]?.value,c=JSON.parse(s||"{}"),f=c?.returnedData||[];this.totalRecords=c?.TotalRecords||0,this.dataSource.data=f}catch(s){console.error("Error parsing response:",s),this.dataSource.data=[],this.totalRecords=0}},error:n=>{console.error("Tally Verification Error:",n),this.dataSource.data=[]},complete:()=>{this.isLoading=!1,this.cdr.detectChanges()}})}ngOnDestroy(){this.getAll2Subscription&&this.getAll2Subscription.unsubscribe()}toggleColumn(e){if(e.isActive)this.displayedColumns.splice(e.position>this.displayedColumns.length-1?this.displayedColumns.length-1:e.position,0,e.name);else{let i=this.displayedColumns.indexOf(e.name);i>-1&&this.displayedColumns.splice(i,1)}console.log(this.displayedColumns)}initializeColumnProperties(){this.displayedColumns.forEach((e,i)=>{"Status"!=e&&"Lots"!=e&&this.columnShowHideList.push({position:i,name:e,isActive:!0})}),this.columnShowHideList.push({position:this.columnShowHideList.length,name:"Lots",isActive:!1})}createFilter(){return(e,i)=>{const n=JSON.parse(i);return Object.keys(n).every(s=>e[s].toString().toLowerCase().includes(n[s].toLowerCase()))}}onPrintAccessInvoice(){this.IheaderService.TallyVerificationPrint(this.IHTALY,this.filters.WLOT,this.filters.WSERL,this.filters.WSUPP).subscribe({next:u=>{console.log("Print tally verification response:",u);const p=u?.[0]?.data?.[2]?.value;p===h.R.ReportCreateMessage?this.successMessage(p):this.failureMessage(p)},error:u=>{console.error("Print tally verificationerror:",u),this.failureMessage("Submission Failed")}})}onPostAccessInvoice(){this.IheaderService.TallyVerificationPost(this.IHTALY).subscribe({next:n=>{console.log("Post tally verification response:",n);const s=n?.[0]?.data?.[2]?.value;s===h.R.updated?this.successMessage(s):this.failureMessage(s)},error:n=>{console.error("Post Access Invoice error:",n),this.failureMessage("Submission Failed")}})}successMessage(e){g().fire(e,"","success")}failureMessage(e){g().fire(e,"","error")}onBack(){this.router.navigate([this.TallyReadURL])}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(m.qu),t.Y36(y.F0),t.Y36(y.gz),t.Y36(U.X),t.Y36(t.sBO))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-tallys-verification"]],viewQuery:function(e,i){if(1&e&&t.Gf(T.NW,5),2&e){let n;t.iGM(n=t.CRH())&&(i.paginator=n.first)}},standalone:!0,features:[t.jDz],decls:57,vars:12,consts:[["mat-button","",1,"backButton","go-back-btn",3,"click"],[1,"buttons"],["mat-button","","class","addButton",3,"click",4,"ngIf"],["mat-button","","class","addButton","matTooltip","Search tally verification",3,"click",4,"ngIf"],["mat-button","","type","reset","value","Reset","matTooltip","Reset Tally Verification",1,"addButton","buttons",3,"click"],[1,"menu-container"],["mainMenuButton","matMenu"],[1,"grid-container"],[4,"ngFor","ngForOf"],["mat-button","","matTooltip","Hide/Show Columns",1,"mat-focus-indicator","addButton","mat-button","mat-button-base","tally-toltip-btn",3,"matMenuTriggerFor"],["menuTrigger","matMenuTrigger"],[1,"tally-serach-form"],["class","form over-Flow",3,"formGroup",4,"ngIf"],["mat-table","",1,"mat-elevation-z8","tally-table",3,"dataSource"],["matColumnDef","Item"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","InTransit"],["matColumnDef","Received"],["matColumnDef","Damaged"],["matColumnDef","Variance"],["matColumnDef","Status"],["matColumnDef","Lots"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"Content-page-both"],[1,"left-side"],["mat-raised-button","","type","submit",1,"buttons","addButton","tally-search-btn",3,"click"],["showFirstLastButtons","",1,"tally-table-pagination",3,"length","pageSizeOptions","pageSize","page"],["paginator",""],["mat-button","",1,"addButton",3,"click"],["mat-button","","matTooltip","Search tally verification",1,"addButton",3,"click"],[1,"row"],[1,"grid-item"],[3,"click"],[2,"color","blue",3,"ngModel","ngModelChange","change"],[1,"form","over-Flow",3,"formGroup"],[1,"col"],["appearance","outline",1,"full-width"],["readonly","","matInput","","formControlName","Tally"],["readonly","","matInput","","formControlName","Carrier"],["readonly","","matInput","","formControlName","storer"],["appearance","outline",1,"full-width2"],["readonly","","matInput","","formControlName","Reference"],["matInput","","readonly","","formControlName","Appointment"],["matInput","","readonly","","formControlName","BuildingDoor"],["matInput","","readonly","","formControlName","ApptDate"],["matInput","","readonly","","formControlName","TrailerNumber"],["matInput","","formControlName","TallyExist","readonly",""],["formControlName","TallyVariance"],["value",""],["value","Y"],["value","N"],["formControlName","TallyDamaged"],["class","buttons addButton tally-search-btn","mat-raised-button","","type","submit","placeholder","Search",4,"ngIf"],["mat-raised-button","","type","submit","placeholder","Search",1,"buttons","addButton","tally-search-btn"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(e,i){if(1&e&&(t.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title")(3,"button",0),t.NdJ("click",function(){return i.onBack()}),t.TgZ(4,"mat-icon"),t._uU(5,"navigate_before "),t.qZA()(),t._uU(6," Tally Verification "),t.qZA(),t.TgZ(7,"div",1),t.YNc(8,R,3,0,"button",2),t.YNc(9,N,3,0,"button",3),t.TgZ(10,"button",4),t.NdJ("click",function(){return i.resetSearch()}),t.TgZ(11,"mat-icon"),t._uU(12,"loop"),t.qZA()(),t.TgZ(13,"mat-menu",5,6)(15,"div",7),t.YNc(16,V,6,2,"ng-container",8),t.qZA()(),t.TgZ(17,"button",9,10)(19,"mat-icon"),t._uU(20,"visibility_off"),t.qZA()()()(),t.TgZ(21,"mat-card-content",11),t.YNc(22,L,58,2,"form",12),t.qZA(),t.TgZ(23,"table",13),t.ynx(24,14),t.YNc(25,B,2,0,"th",15),t.YNc(26,q,2,1,"td",16),t.BQk(),t.ynx(27,17),t.YNc(28,W,2,0,"th",15),t.YNc(29,Y,2,1,"td",16),t.BQk(),t.ynx(30,18),t.YNc(31,K,2,0,"th",15),t.YNc(32,J,2,1,"td",16),t.BQk(),t.ynx(33,19),t.YNc(34,Q,2,0,"th",15),t.YNc(35,F,2,1,"td",16),t.BQk(),t.ynx(36,20),t.YNc(37,w,2,0,"th",15),t.YNc(38,k,2,1,"td",16),t.BQk(),t.ynx(39,21),t.YNc(40,H,2,0,"th",15),t.YNc(41,z,2,1,"td",16),t.BQk(),t.ynx(42,22),t.YNc(43,G,2,0,"th",15),t.YNc(44,$,2,1,"td",16),t.BQk(),t.YNc(45,j,1,0,"tr",23),t.YNc(46,X,1,0,"tr",24),t.qZA(),t._UZ(47,"br")(48,"br"),t.TgZ(49,"div",25)(50,"div",26)(51,"button",27),t.NdJ("click",function(){return i.onPostAccessInvoice()}),t._uU(52,"Post & Print"),t.qZA(),t.TgZ(53,"button",27),t.NdJ("click",function(){return i.onPrintAccessInvoice()}),t._uU(54," Print "),t.qZA()()(),t.TgZ(55,"mat-paginator",28,29),t.NdJ("page",function(s){return i.onPaginateChange(s)}),t.qZA()()),2&e){const n=t.MAs(14);t.xp6(8),t.Q6J("ngIf",i.searchTextDisplay),t.xp6(1),t.Q6J("ngIf",!i.searchTextDisplay),t.xp6(7),t.Q6J("ngForOf",i.columnShowHideList),t.xp6(1),t.Q6J("matMenuTriggerFor",n),t.xp6(5),t.Q6J("ngIf",i.searchTextDisplay),t.xp6(1),t.Q6J("dataSource",i.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(9),t.Q6J("length",i.totalRecords)("pageSizeOptions",t.DdM(11,tt))("pageSize",i.pageSize)}},dependencies:[D.m,C.sg,C.O5,m._Y,m.Fj,m.JJ,m.JL,m.On,m.sg,m.u,T.NW,b.Hw,Z.VK,Z.p6,I.lW,A.KE,A.hX,M.Nt,P.gD,v.ey,_.a8,_.dk,_.dn,_.n5,r.BZ,r.fO,r.as,r.w1,r.Dz,r.nj,r.ge,r.ev,r.XQ,r.Gk,S.gM,O.Rr]}),a})()}}]);